<html lang="en">
<head>
<link rel="stylesheet" href="style.css" />
<link rel="icon" href="favicon.png" />
<script src="src/Raffle.js"></script>
<script src="src/Graph.js"></script>
<script src="src/NSI.js"></script>
<script src="src/RaffleSelectUI.js"></script>
<script src="src/UI.js"></script>
<title>Raffle Predictor</title>
<script>

window.addEventListener('load', () => {
	Raffle.set_engine(new Raffle.SharedWebWorkerEngine({workers: 8}));

	const raffleSelectUI = new RaffleSelectUI();
	const ui = new UI({
		GraphClass: Graph,
		defaultTickets: 10000,
		graphLimit: 10000,
		maxTickets: 50000,
		ticketCost: 1,
	});

	raffleSelectUI.set_callback((raffle) => {
		ui.set_raffle(raffle);
	});

	raffleSelectUI.add_loader('Load latest prizes from NS&I', () =>
		NSI.load().then(({last, next}) => {
			raffleSelectUI.add(
				'Previous NS&I Raffle',
				Raffle.from(last, {pCutoff: 1e-10})
			);
			raffleSelectUI.select(raffleSelectUI.add(
				'Predicted Next NS&I Raffle',
				Raffle.from(next, {pCutoff: 1e-10})
			));
		})
	);

	raffleSelectUI.add(
		'NS&I Premium Bonds Snapshot used by MSE',
		Raffle.from(new NSI([
			{value: 1000000, count:       2},
			{value:  100000, count:       4},
			{value:   50000, count:      10},
			{value:   25000, count:      17},
			{value:   10000, count:      43},
			{value:    5000, count:      87},
			{value:    1000, count:    1677},
			{value:     500, count:    5031},
			{value:     100, count:   22984},
			{value:      50, count:   22984},
			{value:      25, count: 2879959},
			{value:       0, count: 71850560383},
		]), {pCutoff: 1e-10})
	);

	raffleSelectUI.select(raffleSelectUI.add(
		'NS&I Premium Bonds Snapshot (March 2018)',
		Raffle.from(new NSI([
			{value: 1000000, count:       2},
			{value:  100000, count:       5},
			{value:   50000, count:       8},
			{value:   25000, count:      19},
			{value:   10000, count:      46},
			{value:    5000, count:      92},
			{value:    1000, count:    1717},
			{value:     500, count:    5151},
			{value:     100, count:   23554},
			{value:      50, count:   23554},
			{value:      25, count: 2950583},
		], {audienceMultiplier: 24500}), {pCutoff: 1e-10})
	));

	document.body.appendChild(raffleSelectUI.dom());
	document.body.appendChild(ui.dom());
});
</script>
</head>
<body>
</body>
</html>
